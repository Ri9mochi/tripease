<%= render 'shared/header' %>

<div class="split-screen-container">
  <div class="split-panel right-panel">
    <div class="form-card">
      <h2 class="form-title">旅行の条件を編集</h2>

      <%= form_with(model: @travel_plan, local: true) do |f| %>
        <div class="field">
          <%= f.label :name, "プラン名" %><br />
          <%= f.text_field :name, class: "form-input", placeholder: "例：京都の紅葉を満喫する旅" %>
        </div>
        
        <div class="field">
          <%= f.label :destination_ids, "行き先（複数選択可）" %><br />

          <div data-controller="destination-filter">
            <select data-destination-filter-target="groupSelect" data-action="change->destination-filter#update" class="form-input">
              <option value="">地方を選択してください</option>
              <% @prefecture_groups.each do |group| %>
                <option value="<%= group.id %>"><%= group.name %></option>
              <% end %>
            </select>

            <div id="destination-checkboxes">
              <% @destinations.each do |destination| %>
                <div data-destination-filter-target="destination" data-prefecture-group="<%= destination.prefecture_group_id %>">
                  <%= f.check_box :destination_ids, { multiple: true, checked: @travel_plan.destination_ids.include?(destination.id) }, destination.id, nil %>
                  <%= destination.name %>
                </div>
              <% end %>
            </div>
          </div>
        </div>

        <div class="field">
          <%= f.label :start_date, "開始日" %><br />
          <%= f.date_field :start_date, class: "form-input" %>
        </div>

        <div class="field">
          <%= f.label :end_date, "終了日" %><br />
          <%= f.date_field :end_date, class: "form-input" %>
        </div>

        <div class="field">
          <%= f.label :budget, "予算（目安）" %><br />
          <%= f.number_field :budget, class: "form-input", placeholder: "例：50000" %>
        </div>

        <div class="field">
          <%= f.label :notes, "その他ニーズ（AIに伝えたいこと）" %><br />
          <%= f.text_area :notes, class: "form-textarea", placeholder: "例：温泉宿に泊まりたい、歴史的な場所を巡りたい" %>
        </div>

        <div class="actions form-actions-edit">
          <%= f.submit "更新する", class: "form-submit-button" %>
          <%= link_to "戻る", travel_plan_path(@travel_plan), class: "back-button" %>
        </div>
      <% end %>
    </div>
  </div>
</div>